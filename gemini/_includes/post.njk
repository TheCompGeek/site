---
layout: base.njk
---
{% from "partials/card.njk" import card %}{% set hasfm = false %}
{% for collection,settings in collectionsControl -%}
    {% set frontmatter = getContext()[collection] %}
    {% if frontmatter -%}{{collection if not hasfm else '\n' + collection}}:
        {% if frontmatter | getType == 'array' -%}
            {% for item in frontmatter %}
=> gemini://gmi.boehs.org/{{collectionsControl[collection].single or collection}}/{{item}}.gmi {{item}}{{'\n' if not loop.last }}{% endfor %}
        {% elseif frontmatter | getType == 'date' %}
{{page.date.toUTCString()}}
        {% else %}
=> gemini://gmi.boehs.org/{{collectionsControl[collection].single or collection}}/{{frontmatter}}.gmi {{frontmatter}}
        {%- endif %}
        {% set hasfm = true %}
    {%- endif %}
{%- endfor %}

{% for collection,settings in collectionsControl %}
    {% set frontmatter = getContext()[collection] %}
    {% if frontmatter %}
        {% set item = tagList[collection][frontmatter] %}
        {% if item.showOnPost %}
            {{ card({
                url: "/" + collection + "/" + frontmatter,
                title: frontmatter,
                icon: item.icon
            },{
                content: item.description
            }) }}
        {% endif %}
    {% endif %}
{% endfor %}

{{- content | safe -}}
{% if not backlinks | length == 0 %}
{{'\n'}}
## What links here?
    {% for backlink in backlinks %}
=> gemini://gmi.boehs.org{{backlink.url}} {{backlink.title}}
    {% endfor %}
{% endif %}